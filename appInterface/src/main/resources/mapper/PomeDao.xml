<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.qin.dao.PomeDao">

    <select id="findPomeBySearchText"  resultType="cn.qin.vo.pomeVo.PomeSearchVo">
        select
        pome.pome_id,
        pome.name,
        pome.author_id,
        author.name as  authorName
        from pome
        left join author on author.author_id = pome.author_id
        where  1=1
        AND pome.name like #{searchText} or author.name like #{searchText}
        order by INSTR(pome.name,#{text})
    </select>

    <select id="findPomeDetailById"  resultType="cn.qin.vo.pomeVo.PomeVo">
        select
            pome.*,
            author.name as authorName
        from pome
        left join author on author.author_id = pome.author_id
        where  pome.pome_id = #{pomeId};
    </select>

    <select id="findPomeListByPage"  parameterType="java.lang.String" resultType="cn.qin.vo.pomeVo.PomeVo">
        select
            pome.*,
            author.name as authorName
        from pome
        left join author on author.author_id = pome.author_id
        where  1=1
        <if test="pomeVo.authorName != null">
            AND author.name like #{pomeVo.authorName}
        </if>
    </select>



    <select id="findRandomPomeForSize"  resultType="cn.qin.vo.pomeVo.PomeSearchVo">
        select
        pome.pome_id,
        pome.name,
        pome.author_id,
        author.name as authorName
        from pome
        left join author on author.author_id = pome.author_id
        ORDER BY RAND() LIMIT #{size}
    </select>

    <select id="findPomeDaily"  resultType="cn.qin.vo.pomeVo.PomeVo">
        select
            pome.*,
            author.name as authorName
        from pome
        left join author on author.author_id = pome.author_id
        ORDER BY RAND() LIMIT 1
    </select>

</mapper>